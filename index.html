<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Express</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <!-- Supabase config: set these meta tags with your project values -->
    <meta
      name="supabase-url"
      content="https://lfmrmxzgrfbcsoigafiu.supabase.co" />
    <meta
      name="supabase-anon-key"
      content="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxmbXJteHpncmZiY3NvaWdhZml1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3NjM4OTIsImV4cCI6MjA3MzMzOTg5Mn0.pxnjY8xufkvLDUeAgwhR-sDC913lwb5TvBy-a_ap478" />
    <!-- Paystack Inline JS -->
    <script src="https://js.paystack.co/v1/inline.js"></script>
  </head>
  <body>
  <!-- Boot overlay shown while auth session is checked to avoid UI flicker -->
  <div id="boot-overlay" class="boot-overlay" aria-hidden="true" hidden>
      <div class="boot-content">
        <img
          src="https://img.icons8.com/ios-filled/80/ffffff/lotus.png"
          alt="Express" />
      </div>
    </div>
    <div class="container">
      <div class="card">
        <div class="wavy-header">
          <div class="logo-container">
            <img
              src="https://img.icons8.com/ios-filled/50/ffffff/lotus.png"
              alt="Logo"
              class="logo" />
            <span class="app-name">Express Data Service</span>
          </div>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1440 320"
            class="wavy-svg wavy-svg-1">
            <path
              fill="#ffffff"
              fill-opacity="0.3"
              d="M0,160L48,181.3C96,203,192,245,288,240C384,235,480,181,576,176C672,171,768,213,864,218.7C960,224,1056,192,1152,160C1248,128,1344,96,1392,80L1440,64L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
          </svg>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1440 320"
            class="wavy-svg wavy-svg-2">
            <path
              fill="#ffffff"
              fill-opacity="1"
              d="M0,224L48,213.3C96,203,192,181,288,192C384,203,480,245,576,250.7C672,256,768,224,864,197.3C960,171,1056,149,1152,154.7C1248,160,1344,192,1392,208L1440,224L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
          </svg>
        </div>
        <div class="form-container" id="login-form">
          <h2>Welcome Back!</h2>
          <form>
            <div class="input-group">
              <input
                id="login-email"
                type="email"
                placeholder="Email"
                required />
            </div>
            <div class="input-group">
              <input
                id="login-password"
                type="password"
                placeholder="Password"
                required />
              <button
                type="button"
                class="password-toggle"
                data-target="login-password"
                aria-label="Show password">
                <i class="fa fa-eye"></i>
              </button>
            </div>
            <div class="options">
              <label><input type="checkbox" /> Remember me</label>
              <a href="#">Forgot password?</a>
            </div>
            <button id="login-btn" type="submit" class="btn">
              <span>Login</span>
            </button>
          </form>

          <p class="switch-form">
            Don't have an account? <a href="#" id="show-signup">Sign up</a>
          </p>
        </div>

        <div class="form-container" id="signup-form" style="display: none">
          <h2>Create Account</h2>
          <form>
            <div class="input-group">
              <input
                id="signup-name"
                type="text"
                placeholder="Full Name"
                required />
            </div>
            <div class="input-group">
              <input
                id="signup-email"
                type="email"
                placeholder="Email"
                required />
            </div>
            <div class="input-group">
              <input
                id="signup-password"
                type="password"
                placeholder="Password"
                required />
              <button
                type="button"
                class="password-toggle"
                data-target="signup-password"
                aria-label="Show password">
                <i class="fa fa-eye"></i>
              </button>
            </div>
            <button id="signup-btn" type="submit" class="btn">
              <span>Sign Up</span>
            </button>
          </form>
          <p class="switch-form">
            Already have an account? <a href="#" id="show-login">Login</a>
          </p>
        </div>
      </div>
    </div>
  <!-- Main UI (shown after auth) -->
  <div id="main-ui" class="container full-width" style="display: none">
      <div class="card">
        <div class="main-ui-inner" style="padding: 18px">
          <!-- Top bar: left avatar+name, right SIM+logout -->
          <div class="main-topbar">
            <div class="topbar-left">
              <img id="profile-pic" src="" alt="avatar" class="profile-pic" />
              <div class="profile-info-top">
                <div class="greeting">Hello,</div>
                <div id="profile-name" class="profile-name">User</div>
              </div>
            </div>
            <div class="topbar-right">
              <div class="sim-card-mini" id="sim-card">
                <div class="sim-chip-mini">
                  <div class="chip-lines-mini"></div>
                </div>
                <div class="sim-card-content">
                  <div class="sim-title">Phone Number</div>
                  <div id="sim-number" class="sim-number">+233 XX XXX XXXX</div>
                  <div class="sim-balance-mini">
                    <span class="balance-label">Balance:</span>
                    <span id="sim-plan" class="sim-plan">GHS 0.00</span>
                  </div>
                </div>
              </div>
              <button id="logout-btn" class="btn small">Logout</button>
            </div>
          </div>

          <!-- Main content placeholder (pushed below topbar) -->
          <div class="content-area" style="margin-top: 24px">
            <!-- Horizontal scroll cards -->
            <div class="cards-scroll" aria-label="quick-cards">
              <div class="card-item" data-provider="MTN" role="button" tabindex="0" aria-label="Open MTN details">
                <h3>MTN</h3>
                <p class="muted">Mobile network details & quick actions</p>
              </div>
              <div class="card-item" data-provider="Airteltigo" role="button" tabindex="0" aria-label="Open Airteltigo details">
                <h3>Airteltigo</h3>
                <p class="muted">Mobile network details & quick actions</p>
              </div>
              <div class="card-item" data-provider="Telecel" role="button" tabindex="0" aria-label="Open Telecel details">
                <h3>Telecel</h3>
                <p class="muted">Mobile network details & quick actions</p>
              </div>
            </div>
            <!-- Transactions / Statistics -->
            <div class="transactions-section" style="margin-top: 18px">
              <h3>Recent Transactions</h3>
              <div id="transactions-list" class="transactions-list">
                <!-- populated by JS -->
              </div>
            </div>
            </div>

            <!-- Provider Detail Page (hidden by default) -->
            <div id="provider-detail" class="provider-detail" style="display: none; margin-top: 24px">
              <div class="provider-header-row">
                <button id="provider-back-btn" class="provider-back-btn" aria-label="Go back">
                  <i class="fa fa-arrow-left"></i> Back
                </button>
                <h2 id="provider-name">Provider</h2>
              </div>
              <div class="provider-content">
                <div class="provider-offers">
                  <h3>Available Offers</h3>
                  <div id="provider-offers-list" class="offers-list">
                    <!-- populated by JS from Supabase -->
                  </div>
                </div>
                <div class="provider-history">
                  <h3>Provider Transactions</h3>
                  <div id="provider-transactions" class="transactions-list">
                    <!-- populated by JS -->
                  </div>
                </div>
              </div>
            </div>

            <!-- Account Page (hidden by default) -->
            <div id="account-page" class="account-page" style="display: none; margin-top: 24px">
              <div class="account-header-row">
                <button id="account-back-btn" class="account-back-btn" aria-label="Go back">
                  <i class="fa fa-arrow-left"></i> Back
                </button>
                <h2>Account Settings</h2>
              </div>
              
              <div class="account-content">
                <!-- Profile Section -->
                <div class="account-section">
                  <h3><i class="fa fa-user"></i> Profile Information</h3>
                  <div class="account-card">
                    <div class="account-profile-header">
                      <img id="account-profile-pic" src="" alt="avatar" class="account-avatar" />
                      <div class="account-profile-info">
                        <div id="account-name" class="account-name">User Name</div>
                        <div id="account-email" class="account-email">user@email.com</div>
                      </div>
                    </div>
                    <button id="edit-profile-btn" class="account-btn secondary">
                      <i class="fa fa-edit"></i> Edit Profile
                    </button>
                  </div>
                </div>

                <!-- SIM Card Section -->
                <div class="account-section">
                  <h3><i class="fa fa-sim-card"></i> SIM Card</h3>
                  <div class="account-card sim-card-display">
                    <div class="sim-card-chip">
                      <div class="chip-lines"></div>
                    </div>
                    <div class="sim-card-info">
                      <div class="sim-card-label">Phone Number</div>
                      <div id="account-phone" class="sim-card-number">+233 XX XXX XXXX</div>
                    </div>
                    <div class="sim-card-balance-section">
                      <div class="sim-balance-label">Wallet Balance</div>
                      <div id="account-balance" class="sim-balance-amount">GHS 0.00</div>
                    </div>
                    <div class="sim-card-provider" id="account-provider">
                      <i class="fa fa-signal"></i>
                      <span>Network Provider</span>
                    </div>
                  </div>
                  <button class="account-btn primary" style="margin-top: 12px;">
                    <i class="fa fa-plus"></i> Add Funds
                  </button>
                </div>

                <!-- Settings List -->
                <div class="account-section">
                  <h3><i class="fa fa-cog"></i> Settings</h3>
                  <div class="account-list">
                    <div class="account-list-item" data-action="notifications">
                      <div class="list-item-left">
                        <i class="fa fa-bell"></i>
                        <span>Notifications</span>
                      </div>
                      <i class="fa fa-chevron-right"></i>
                    </div>
                    <div class="account-list-item" data-action="security">
                      <div class="list-item-left">
                        <i class="fa fa-lock"></i>
                        <span>Security & Privacy</span>
                      </div>
                      <i class="fa fa-chevron-right"></i>
                    </div>
                    <div class="account-list-item" data-action="payment">
                      <div class="list-item-left">
                        <i class="fa fa-credit-card"></i>
                        <span>Payment Methods</span>
                      </div>
                      <i class="fa fa-chevron-right"></i>
                    </div>
                    <div class="account-list-item" data-action="preferences">
                      <div class="list-item-left">
                        <i class="fa fa-sliders-h"></i>
                        <span>Preferences</span>
                      </div>
                      <i class="fa fa-chevron-right"></i>
                    </div>
                  </div>
                </div>

                <!-- Support Section -->
                <div class="account-section">
                  <h3><i class="fa fa-question-circle"></i> Support</h3>
                  <div class="account-list">
                    <div class="account-list-item" data-action="help">
                      <div class="list-item-left">
                        <i class="fa fa-life-ring"></i>
                        <span>Help Center</span>
                      </div>
                      <i class="fa fa-chevron-right"></i>
                    </div>
                    <div class="account-list-item" data-action="contact">
                      <div class="list-item-left">
                        <i class="fa fa-envelope"></i>
                        <span>Contact Us</span>
                      </div>
                      <i class="fa fa-chevron-right"></i>
                    </div>
                    <div class="account-list-item" data-action="about">
                      <div class="list-item-left">
                        <i class="fa fa-info-circle"></i>
                        <span>About</span>
                      </div>
                      <i class="fa fa-chevron-right"></i>
                    </div>
                  </div>
                </div>

                <!-- Logout Button -->
                <div class="account-section">
                  <button id="account-logout-btn" class="account-btn danger full-width">
                    <i class="fa fa-sign-out-alt"></i> Logout
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Toast for alerts/errors -->
    <div
      id="toast"
      class="toast"
      aria-live="polite"
      aria-atomic="true"
      hidden></div>

    <!-- Phone Update Modal -->
    <div id="phone-update-modal" class="modal-overlay" aria-hidden="true" hidden>
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fa fa-mobile-alt"></i> Update Phone Number</h3>
          <button id="phone-modal-close" class="modal-close" aria-label="Close">
            <i class="fa fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-description">Enter your phone number to link with your SIM card</p>
          <div class="input-group">
            <label for="phone-input">Phone Number</label>
            <input
              id="phone-input"
              type="tel"
              placeholder="+233 XX XXX XXXX"
              class="modal-input" />
          </div>
          <div class="input-group">
            <label for="provider-select">Network Provider</label>
            <select id="provider-select" class="modal-input">
              <option value="">Select Provider</option>
              <option value="MTN">MTN</option>
              <option value="Airteltigo">Airteltigo</option>
              <option value="Telecel">Telecel</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button id="phone-cancel-btn" class="modal-btn secondary">
            Cancel
          </button>
          <button id="phone-save-btn" class="modal-btn primary">
            <i class="fa fa-save"></i> Save Changes
          </button>
        </div>
      </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="edit-profile-modal" class="modal-overlay" aria-hidden="true" hidden>
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fa fa-user-edit"></i> Edit Profile</h3>
          <button id="profile-modal-close" class="modal-close" aria-label="Close">
            <i class="fa fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-description">Update your profile information</p>
          <div class="input-group">
            <label for="username-input">Username</label>
            <input
              id="username-input"
              type="text"
              placeholder="Enter your username"
              class="modal-input" />
          </div>
          <div class="input-group">
            <label for="profile-phone-input">Phone Number</label>
            <input
              id="profile-phone-input"
              type="tel"
              placeholder="+233 XX XXX XXXX"
              class="modal-input" />
          </div>
        </div>
        <div class="modal-footer">
          <button id="profile-cancel-btn" class="modal-btn secondary">
            Cancel
          </button>
          <button id="profile-save-btn" class="modal-btn primary">
            <i class="fa fa-save"></i> Save Changes
          </button>
        </div>
      </div>
    </div>

    <!-- Loading modal shown during auth requests -->
    <div id="loading-modal" class="loading-modal" aria-hidden="true" hidden>
      <div class="loading-content">
        <div class="spinner" role="status" aria-hidden="true"></div>
        <div class="loading-text">Processing...</div>
      </div>
    </div>

    <!-- Recipient Phone Modal (for buying for others) -->
    <div id="recipient-phone-modal" class="modal-overlay" aria-hidden="true" hidden>
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fa fa-gift"></i> Buy for Someone Else</h3>
          <button id="recipient-modal-close" class="modal-close" aria-label="Close">
            <i class="fa fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-description">Enter the recipient's phone number to send this offer</p>
          <div class="input-group">
            <label for="recipient-phone-input">Recipient's Phone Number</label>
            <input
              id="recipient-phone-input"
              type="tel"
              placeholder="+233 XX XXX XXXX or 0XX XXX XXXX"
              class="modal-input"
              autocomplete="tel" />
            <small style="color: #666; font-size: 12px; margin-top: 4px; display: block;">
              Format: +233XXXXXXXXX or 0XXXXXXXXX
            </small>
          </div>
        </div>
        <div class="modal-footer">
          <button id="recipient-cancel-btn" class="modal-btn secondary">
            Cancel
          </button>
          <button id="recipient-proceed-btn" class="modal-btn primary">
            <i class="fa fa-credit-card"></i> Proceed to Payment
          </button>
        </div>
      </div>
    </div>

    <script type="module" src="script.js"></script>
  </body>
</html>
